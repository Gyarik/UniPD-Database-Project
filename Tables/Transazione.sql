DROP TABLE IF EXISTS Transazione;
DROP TYPE IF EXISTS transazione;

CREATE TYPE transazione AS ENUM ('Uscita', 'Entrata', 'Fattura', 'Stipendio');

CREATE TABLE Transazione (
    id_trz INT NOT NULL,
    id_sede INT NOT NULL,
    tipologia transazione NOT NULL,
    saldo DECIMAL (7,2) NOT NULL CHECK (saldo <> 0),
    descrizione VARCHAR (300),
    data_trz DATE NOT NULL,
    PRIMARY KEY (id_trz, id_sede),
    FOREIGN KEY (id_sede) REFERENCES Sede(id_sede) ON UPDATE CASCADE ON DELETE CASCADE,
    CHECK (((tipologia = 'Uscita' OR tipologia = 'Stipendio') AND saldo < 0) or ((tipologia = 'Entrata' OR tipologia = 'Fattura') and saldo > 0))
);

INSERT INTO Transazione (id_trz, id_sede, tipologia, saldo, data_trz)
VALUES
    (1, 389, 'Uscita', -2550, '2020-12-1'),
    (2, 389, 'Entrata', 2200, '2020-12-1'),
    (3, 389, 'Fattura', 4200, ''),
    (4, 389, 'Stipendio', -3520, ),
    (5, 389, 'Uscita', -4370, ),
    (6, 389, 'Entrata', 3758),
    (7, 389, 'Fattura', 4550),
    (8, 389, 'Stipendio', -1500),
    (9, 389, 'Uscita', -12300),
    (10, 389, 'Entrata', 20000),
    (11, 389, 'Fattura'),
    (12, 389, 'Stipendio'),
    (, 389, 'Uscita', -2550, ),
    (, 389, 'Entrata', 2200, ),
    (, 389, 'Fattura', 4200),
    (, 389, 'Stipendio', -3520, ),
    (, 389, 'Uscita', , ),
    (, 389, 'Entrata', , ),
    (, 389, 'Fattura', ),
    (, 389, 'Stipendio',, ),
    (, 389, 'Uscita', , ),
    (, 389, 'Entrata', , ),
    (, 389, 'Fattura', ),
    (, 389, 'Stipendio',, ),
    (, 389, 'Uscita', , ),
    (, 389, 'Entrata', , ),
    (, 389, 'Fattura', ),
    (, 389, 'Stipendio',, ),



    (, 437, 'Uscita'),
    (, 437, 'Entrata'),
    (, 437, 'Fattura'),
    (, 437, 'Stipendio'),
    (, 437, 'Stipendio'),
    (, 437, 'Uscita'),
    (, 437, 'Entrata'),
    (, 437, 'Fattura'),
    (, 437, 'Stipendio'),
    (, 437, 'Stipendio'),
    (, 437, 'Uscita'),
    (, 437, 'Entrata'),
    (, 437, 'Fattura'),
    (, 437, 'Stipendio'),
    (, 437, 'Stipendio'),

    (, 594, 'Uscita'),
    (, 594, 'Entrata'),
    (, 594, 'Fattura'),
    (, 594, 'Stipendio'),
    (, 594, 'Stipendio'),
    (, 594, 'Uscita'),
    (, 594, 'Entrata'),
    (, 594, 'Fattura'),
    (, 594, 'Stipendio'),
    (, 594, 'Stipendio'),
    (, 594, 'Uscita'),
    (, 594, 'Entrata'),
    (, 594, 'Fattura'),
    (, 594, 'Stipendio'),
    (, 594, 'Stipendio'),

    (, 239, 'Uscita'),
    (, 239, 'Entrata'),
    (, 239, 'Fattura'),
    (, 239, 'Stipendio'),
    (, 239, 'Stipendio'),
    (, 239, 'Uscita'),
    (, 239, 'Entrata'),
    (, 239, 'Fattura'),
    (, 239, 'Stipendio'),
    (, 239, 'Stipendio'),
    (, 239, 'Uscita'),
    (, 239, 'Entrata'),
    (, 239, 'Fattura'),
    (, 239, 'Stipendio'),
    (, 239, 'Stipendio'),

    (, 312, 'Uscita'),
    (, 312, 'Entrata'),
    (, 312, 'Fattura'),
    (, 312, 'Stipendio'),
    (, 312, 'Stipendio')
    (, 312, 'Uscita'),
    (, 312, 'Entrata'),
    (, 312, 'Fattura'),
    (, 312, 'Stipendio'),
    (, 312, 'Stipendio'),
    (, 312, 'Uscita'),
    (, 312, 'Entrata'),
    (, 312, 'Fattura'),
    (, 312, 'Stipendio'),
    (, 312, 'Stipendio'),
    